{% extends "base.html" %}
{% load search_tags %}

{% block content %}
<!-- Bootstrap JS (For dropdown) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<div class="container mt-5" style="min-height:65vh;">
  <div class="search-bar-wrap mx-auto" style="max-width:560px;">
    <form method="get" action="{% url 'cases:advanced_search' %}" class="d-flex align-items-center search-bar-form shadow bg-white p-3 rounded">
      <input name="q" value="{{ query }}" class="form-control me-2 shadow-none search-inp" type="search" placeholder="Search cases, documents, resources..." autofocus required style="font-size:1.1rem;">
      <option value="web" {% if filter_type == "web" %}selected{% endif %}>Web Search</option>

      <select name="type" class="form-select filter-select me-2" style="width:170px;">
        <option value="all" {% if filter_type == "all" %}selected{% endif %}>All</option>
<option value="case" {% if filter_type == "case" %}selected{% endif %}>Cases</option>
<option value="document" {% if filter_type == "document" %}selected{% endif %}>Documents</option>
<option value="resource" {% if filter_type == "resource" %}selected{% endif %}>Legal Resources</option>
<option value="web" {% if filter_type == "web" %}selected{% endif %}>Web Search</option>

      </select>
      <button class="btn btn-warning shadow-sm" type="submit" style="font-weight:bold;">
        <span class="fa fa-search"></span> Search
      </button>
    </form>
  </div>
  <div class="mt-4 animated-fade-in">
    {% if query %}
      <h5 class="text-secondary mb-3">Results for: <mark>{{ query }}</mark></h5>
      {% if results %}
        <ul class="list-group shadow-sm">
          {% for item in results %}
            <li class="list-group-item search-result animated-slide-in">
              {% if item.title %}<strong>{{ item.title }}</strong>{% endif %}
              {% if item.name %}<strong>{{ item.name }}</strong>{% endif %}
              <br>
                <small class="text-muted">Type: {{ item|model_name }}</small>

              {% if item.link %}
  <a href="{{ item.link }}" target="_blank" class="btn btn-link float-end">Go</a>
{% elif item.get_absolute_url %}
  <a href="{{ item.get_absolute_url }}" target="_blank" class="btn btn-link float-end">Go</a>
{% else %}
  <a href="#" class="btn btn-link float-end disabled">Go</a>
{% endif %}

            </li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="alert alert-warning mt-3">No results found.</div>
      {% endif %}
    {% endif %}
  </div>
</div>
<style>
.search-bar-form { transition: box-shadow 0.25s; }
.search-bar-form:focus-within { box-shadow:0 0 12px #ffe066; }
.search-inp:focus { border-color: #ffcc00; box-shadow: 0 0 2px #ffe066;}
.filter-select { transition: border-color 0.22s; }
.filter-select:focus { border-color: #4286f4; }
.animated-fade-in { animation: fadeIn 0.5s; }
.animated-slide-in { animation: slideIn 0.45s; }
@keyframes fadeIn { from { opacity:0; } to {opacity:1;} }
@keyframes slideIn { from { transform:translateY(36px); opacity:0; } to {transform:translateY(0); opacity:1;}}
</style>
{% endblock %}
